@using FeatureDemandPlanning.Model.Empty

@model FeatureDemandPlanning.Model.ViewModel.TakeRateViewModel 

@{ var currentVersion = Model.CurrentVersion; }

<script src="@Url.Content("~/Scripts/Shared/namespace.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/Shared/contextmenu.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/Shared/modal.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/Shared/cookie.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/model.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/changeset.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/details.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/addnote.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/addnoteaction.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/save.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/saveaction.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/history.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/historyaction.js")?v=@Model.CurrentVersion"></script>
<script src="@Url.Content("~/Scripts/TakeRateData/page.js")?v=@Model.CurrentVersion"></script>

<script type="text/javascript">

    var volume, vehicle, pager, page, modal, details, addNote;
    var params = {
        ActionsUri: "@Url.Action("ContextMenu")",
        ModalContentUri: "@Url.Action("ModalContent")",
        ModalActionUri: "@Url.Action("ModalAction")",
        ModalDialogId: "modal",
        ModalContentId: "modalBody",
        GetChangesetUri: "@Url.Action("GetLatestChangeset")",
        RevertChangesetUri: "@Url.Action("RevertLatestChangeset")",
        SaveChangesetUri: "@Url.Action("SaveChangeset")",
        PersistChangesetUri: "@Url.Action("PersistChangeset")",
        PersistChangesetConfirmUri: "@Url.Action("PersistChangesetConfirm")",
        ChangesetHistoryUri: "@Url.Action("ChangesetHistory")",
        UndoChangesetUri: "@Url.Action("UndoChangeset")",
        ValidateUri: "@Url.Action("Validate")",
        ValidationMessageUri: "@Url.Action("ValidationMessage")",
        AddNoteUri: "@Url.Action("AddNoteUri")",
        RefreshNotesUri: "@Url.Action("RefreshNotesUri")",
        Configuration: {},
        OXOVehicle: {},
        PageSize: @Model.PageSize,
        PageIndex: @Model.PageIndex,
        CookieKey: "@Model.CookieKey",
            OxoDocId: null,
        TakeRateId: null,
        MarketGroupId: null,
        MarketId: null
    };

    params.Configuration = @Html.Raw(Json.Encode(Model.Configuration));
    params.Vehicle = @Html.Raw(Json.Encode(Model.Document.Vehicle));
    @if (Model.Document.UnderlyingOxoDocument != null)
    {
        @:params.OxoDocId = @Model.Document.UnderlyingOxoDocument.Id;
    }
    @if (!(Model.Document.Market is EmptyMarket))
    {
        @:params.MarketId = @Model.Document.Market.Id;
    }
    @if (!(Model.Document.MarketGroup is EmptyMarketGroup))
    {
        @:params.MarketGroupId = @Model.Document.MarketGroup.Id;
    }
    @if (Model.Document.TakeRateId.HasValue)
    {
        @:params.TakeRateId = @Model.Document.TakeRateId.Value;
    }
</script>
<script src="@Url.Content("~/Scripts/TakeRateData/init.js")?v=@Model.CurrentVersion"></script>
